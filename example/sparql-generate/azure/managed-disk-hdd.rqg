BASE <https://w3id.org/cocoon/data/> 
PREFIX iter: <http://w3id.org/sparql-generate/iter/>
PREFIX fun: <http://w3id.org/sparql-generate/fn/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX gr: <http://purl.org/goodrelations/v1#>
PREFIX cocoon: <https://raw.githubusercontent.com/miranda-zhang/cloud-computing-schema/master/ontology_dev/cocoon.ttl>

GENERATE { 
  <price_specification/azure/storage_transaction/managed_disk> a cocoon:StorageTransactionsPriceSpecification;
    rdfs:label "Azure managed disks storage transactions price specification";
    gr:hasPriceSpecification [ 
        a gr:UnitPriceSpecification ; 
            gr:hasCurrency "USD"^^xsd:string; 
            gr:hasCurrencyValue ?value; 
            cocoon:hasRegion <region/azure/{?region_slug}>;
    ] 
 
}
SOURCE <https://azure.microsoft.com/api/v2/pricing/managed-disks/calculator/?culture=en-au&discount=mosp> AS ?source
BIND (fun:JSONPath(?source,"$.offers.['transactions-hdd']") AS ?transactions_hdd)

ITERATOR iter:JSONPath(?managed-disks-hdd,"$[*]") AS ?hdd
WHERE {
    BIND (xsd:double ( fun:JSONPath(?prices,"$.{?region_slug}.value") / 10000 ) AS ?value)
}
